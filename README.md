# TikTokDetection
抖音，微博，域名批量检测工具，
# 抖音检测工具 使用说明

## 一、工具介绍

抖音检测工具是一个基于 Python + PyQt5 的桌面程序，用于批量检测域名或链接在抖音内部访问时是否会被拦截。工具通过抖音官方的跳转检测链接，对每个域名/链接发起请求，并根据返回内容判断是“正常”还是“拦截”。

## 二、主要功能

- **批量检测**：
  - 支持在界面左侧输入框直接粘贴大量文本（可以是表格、网页复制的内容等），程序会自动从中提取有效域名。
  - 支持从文本文件导入待检测数据，自动提取其中的域名。

- **智能域名提取**：
  - 使用正则表达式从任意文本中提取形如 `xxx.com`、`abc123.net`、`sctfa.com.cn` 等域名。
  - 自动去重、统一转为小写，只保留干净的域名列表。

- **抖音拦截检测**：
  - 通过 `https://link.wtturl.cn/?aid=1128&lang=zh&scene=im&jumper_version=1&target=...` 这种抖音检测链接，对目标域名进行检测。
  - 若返回 3xx 并带有 `Location` 头，判断为 **“正常”**。
  - 若页面内容包含以下任一关键字，则判断为 **“拦截”**：
    - “第三方网页”
    - “停止”
    - “已终止访问该网页”
  - 其他情况标记为“未知/错误”，不计入“正常链接”，但参与总数统计。

- **微博拦截检测**：
  - 通过 `https://weibo.cn/sinaurl?u=目标地址` 这种微博跳转检测链接，对目标域名进行检测。
  - 若返回 3xx 并带有 `Location` 头，判断为 **“正常”**。
  - 若页面内容包含以下任一关键字，则判断为 **“拦截”**：
    - “将要访问”
    - “已停止访问”
  - 其他情况同样标记为“未知/错误”。

- **多线程检测**：
  - 可在顶部设置检测线程数（默认 10），并行请求，提升检测速度。

- **实时日志与结果展示**：
  - 中间“检测日志”区域实时显示：`域名 -> 正常/拦截/未知/错误`。
  - 右侧“正常链接”区域只列出检测为“正常”的域名，方便复制或导出。

- **统计信息与性能指标**：
  - 按钮下方显示：
    - 待检测域名数
    - 已检测域名数
    - 正常链接数
    - 拦截链接数
    - QPS（每秒检测数量）
    - 耗时（秒）
  - 底部进度条展示整体检测进度。

- **控制功能**：
  - “开始检测抖音”按钮：以抖音接口启动新一轮检测，清空上次日志和结果。
  - “开始检测微博”按钮：以微博接口启动新一轮检测，清空上次日志和结果。
  - “暂停”按钮：可在检测过程中暂停/继续。
  - “导入检测文件”按钮：从 `.txt` 文件中导入数据，自动提取域名到左侧输入框。

## 三、运行环境

- 操作系统：macOS
- 必需软件：
  - Python 3（建议 3.8+）
  - 已安装 `PyQt5` 和 `requests` 库

在终端中安装依赖（如果尚未安装）：

```bash
pip3 install PyQt5 requests
```

## 四、运行方式

在终端中执行：

```bash
cd "/Users/mac/Desktop/抖音检测"
python3 douyin_checker_gui.py
```

运行成功后，会弹出图形界面窗口。

## 五、使用步骤

1. **准备待检测数据**
   - 可以直接从网站/Excel/页面复制一整段文字（包含域名的表格也可以），粘贴到左侧“待检测链接”输入框。
   - 或者，将数据保存为 `.txt` 文件，每页/每行内容不限，界面会自动提取其中所有域名。

2. **导入/粘贴**
   - 方式一：直接粘贴到左侧输入框。
   - 方式二：点击顶部“导入检测文件”，选择 `.txt` 文件，程序会自动从文件中提取域名并填入左侧。

3. **检查提取结果**
   - 导入或粘贴后，左侧输入框中会只显示域名，每行一个，例如：
     - `36581.com`
     - `xpj5.com`
     - `djwma.com`
     - `sctfa.com.cn`
   - 确认无误后继续下一步。

4. **配置线程数**
   - 在顶部“线程数”框中设置并发检测线程数量（默认 10）。
   - 数值越大，速度越快，但也会占用更多网络和系统资源，建议根据实际情况调整。

5. **开始检测**
  - 点击“开始检测抖音”或“开始检测微博”按钮：
     - 中间“检测日志”会滚动显示每个域名的检测结果，例如：`example.com -> 正常`。
     - 右侧“正常链接”列表自动追加检测为“正常”的域名。
     - 下方统计栏实时更新待检测/已检测/正常/拦截数量，显示 QPS 和耗时。
     - 底部进度条随检测进度推进。

6. **暂停/继续检测**
   - 检测过程中，可点击“暂停”按钮暂停任务，再次点击可继续检测。

7. **查看和使用结果**
   - **日志区**：可以查阅每个域名的检测详情。
   - **正常链接区**：可全选复制，用于后续导出或其他操作。

## 六、注意事项

- 若运行时出现与 Qt 平台插件（如 "cocoa"）相关的错误，通常与环境或路径有关，优先尝试：
  - 使用系统自带的 `python3` 运行，而不是路径中带有中文的虚拟环境。
- 大量并发时，可能会受到网络环境或目标站点限制，可适当降低线程数。
- 该工具仅用于检测页面在抖音环境下的大致“正常/拦截”状态，结果受抖音检测页面实现方式和接口策略变化影响。

## 七、命令行版脚本

同目录下还有 `douyin_check.py` 命令行版本，可用于单个链接检测：

```bash
cd "/Users/mac/Desktop/抖音检测"
python3 douyin_check.py "https://example.com"
```

输出：

- `检测结果：正常`
- 或 `检测结果：拦截` / `检测结果：未知` / `检测结果：错误`

可根据需要选择使用 GUI 版或命令行版。

## 八、在 macOS 上打包应用 / 安装包

> 以下操作都在 macOS 上执行，且以项目目录 `/Users/mac/Desktop/抖音检测` 为例。

### 1. 安装打包依赖

在终端执行（只需一次）：

```bash
pip3 install PyQt5 requests PyInstaller Pillow
```

### 2. 打包为带图标的「域名检测.app」

1. 在项目根目录准备一张图标文件 `icon.png`（建议 1024×1024 像素，正方形）。
2. 在终端执行：

  ```bash
  cd "/Users/mac/Desktop/抖音检测"
  python3 -m PyInstaller --windowed --name 域名检测 --icon=icon.png --noconfirm douyin_checker_gui.py
  ```

3. 打包完成后，会在 `dist` 目录下生成：

  - `dist/域名检测.app`

  这就是可直接双击运行的 macOS 应用，Dock 和窗口会显示自定义图标和名称“域名检测”。

### 3. 打包为 macOS 安装包（dmg）

为了方便分发给其他人使用，可以把 `.app` 封装成 dmg：

```bash
cd "/Users/mac/Desktop/抖音检测"
mkdir -p "release/域名检测"
cp -R "dist/域名检测.app" "release/域名检测/"
hdiutil create -volname "域名检测" -srcfolder "release/域名检测" -ov -format UDZO "release/域名检测_Mac.dmg"
```

完成后生成：

- `release/域名检测_Mac.dmg`

给别人安装的方式：

- 双击 `域名检测_Mac.dmg`，在弹出的卷宗窗口中，将 `域名检测.app` 拖到「应用程序」即可。
- 如果首次运行提示“来自未验证的开发者”，可在「系统设置 → 隐私与安全性」中找到对应提示，点击“仍要打开”。

## 九、在 Windows 上打包为 exe（简要说明）

Windows 下无法直接使用 macOS 打好的程序，需要在真正的 Windows 机器上单独打包。大致步骤如下（以目录 `C:\tools\douyin_check` 为例）：

1. 安装 Python 3（64 位），安装时勾选“Add Python to PATH”。
2. 将本项目文件夹拷贝到 Windows，例如：`C:\tools\douyin_check`。
3. 在 Windows 终端执行：

  ```bat
  cd C:\tools\douyin_check
  python -m venv .venv
  .\.venv\Scripts\activate
  pip install PyQt5 requests pyinstaller
  ```

4. 使用 PyInstaller 打包为无控制台窗口的 exe：

  ```bat
  pyinstaller --windowed --name DouyinCheckerWin douyin_checker_gui.py
  ```

5. 打包完成后，在 `dist` 目录下会有：

  - `dist\DouyinCheckerWin\DouyinCheckerWin.exe`

  双击 `DouyinCheckerWin.exe` 即可在 Windows 上运行 GUI 版域名检测工具。
